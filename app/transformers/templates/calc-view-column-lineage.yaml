columns:
  - name: typeName
    source_query: "'ColumnProcess'"

  - name: attributes.name
    source_query: concat(source_schema, '/', coalesce(source_package_id, ''), '/', source_table, '/', source_table_column, ' â†’ ', calc_view_schema, '/', calc_view_package_id, '/', calc_view_name, '/', calc_view_column)
    source_columns: [source_schema, source_package_id, source_table, source_table_column, calc_view_schema, calc_view_package_id, calc_view_name, calc_view_column]
    
  - name: attributes.qualifiedName
    source_query: concat(connection_qualified_name, '/process/', source_schema, '/', coalesce(source_package_id, ''), '/', source_table, '/', source_table_column, '/', calc_view_schema, '/', calc_view_package_id, '/', calc_view_name, '/', calc_view_column)
    source_columns: [connection_qualified_name, source_schema, source_package_id, source_table, source_table_column, calc_view_schema, calc_view_package_id, calc_view_name, calc_view_column]
    
  - name: attributes.connectorName
    source_query: "'sap-hana'"
    
  - name: attributes.connectionQualifiedName
    source_query: connection_qualified_name
    
  - name: attributes.inputs
    source_query: |
      case 
        when source_type = 'CALCULATION_VIEW' then
          concat('[{"typeName":"Column","uniqueAttributes":{"qualifiedName":"', connection_qualified_name, '/DEFAULT/', source_schema, '/', source_package_id, '/', source_table, '/', source_table_column, '"}}]')
        else
          concat('[{"typeName":"Column","uniqueAttributes":{"qualifiedName":"', connection_qualified_name, '/DEFAULT/', source_schema, '/', source_table, '/', source_table_column, '"}}]')
      end
    source_columns: [source_type, connection_qualified_name, source_schema, source_package_id, source_table, source_table_column]
    
  - name: attributes.outputs
    source_query: concat('[{"typeName":"Column","uniqueAttributes":{"qualifiedName":"', connection_qualified_name, '/DEFAULT/', calc_view_schema, '/', calc_view_package_id, '/', calc_view_name, '/', calc_view_column, '"}}]')
    source_columns: [connection_qualified_name, calc_view_schema, calc_view_package_id, calc_view_name, calc_view_column] 